<p-dialog position="top" [(visible)]="showJsonDialog" position="top-right" maximizable="true"
  [style]="{width: '70vw',height:'70vh'}">
  <textarea style="width:'100%';height: 100%;">
    {{results | json}}
  </textarea>
</p-dialog>
<p-table #dt [value]="results" responsiveLayout="scroll" [scrollable]="true" scrollHeight="500px" dataKey="title">
  <ng-template pTemplate="header">
    <tr>
      <ng-container *ngFor="let header of headers">
        <th [pSortableColumn]="header" style="width:20%">
          {{header}}
          <p-sortIcon [field]="header"></p-sortIcon>
        </th>
      </ng-container>
    </tr>
    <tr>
      <ng-container *ngFor="let header of headers">
        <th>
          <ng-container [ngSwitch]="getHeaderType(header)">
            <p-columnFilter *ngSwitchCase="'text'" type="text" [field]="header" [placeholder]="'Zoek in ' + header">
            </p-columnFilter>
            <p-columnFilter *ngSwitchCase="'number'" type="number" [field]="header" [placeholder]="'Zoek in ' + header">
            </p-columnFilter>
            <p-columnFilter *ngSwitchCase="'compact'" type="text" [field]="header" [display]="menu"
              [placeholder]="'Zoek in ' + header">
            </p-columnFilter>



            <p-columnFilter *ngSwitchCase="'site'" [field]="site" matchMode="in" [showMatchModes]="false"
              [showOperator]="false" [showAddButton]="false">

              <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                <p-multiSelect [ngModel]="site" [options]="sources" placeholder="Any"
                  (onChange)="dt.filter($event.value,'site','in')" optionLabel="site" optionValue="site">
                  <ng-template let-option pTemplate="item">
                    <div class="p-multiselect-representative-option">
                      <span class="ml-1">{{option.site}}</span>
                    </div>
                  </ng-template>
                </p-multiSelect>
              </ng-template>
            </p-columnFilter>




            <p-columnFilter *ngSwitchDefault></p-columnFilter>
          </ng-container>
        </th>
      </ng-container>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-item>
    <tr>
      <ng-container *ngFor="let header of headers; index as i">
        <ng-container [ngSwitch]="getType(solveChild(item,header))">
          <td *ngSwitchCase="'image'">
            <p-image [src]="cleanUrlFromImgObject(item[header])" alt="Image" width="150" [preview]="true"></p-image>
          </td>
          <td *ngSwitchCase="'imageurl'">
            <p-image [src]="cleanUrlFromImgUrl(item[header])" alt="Image" width="150" [preview]="true"></p-image>
          </td>
          <td *ngSwitchCase="'html'">
            <p-scrollPanel [style]="{width: '100%', height: '200px'}">
              <div class="htmlContainer" [innerHTML]="solveChild(item,header)"></div>
            </p-scrollPanel>
          </td>
          <td *ngSwitchCase="'url'">
            <button pButton type="button" icon="pi pi-external-link" iconPos="left"
              (click)="openWindow(solveChild(item,header))" [pTooltip]="solveChild(item,header)"
              tooltipPosition="bottom"></button>
          </td>
          <td *ngSwitchDefault>{{solveChild(item,header)}}</td>
        </ng-container>
      </ng-container>
    </tr>
  </ng-template>
</p-table>